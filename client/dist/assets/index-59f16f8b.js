import{j as e,r as i}from"./react-eb7ba1bc.js";import{c as ne}from"./react-dom-5a148aae.js";import{L as U,B as le}from"./react-router-dom-1aad50d4.js";import{S as W,N as V,a as K,b as X}from"./swiper-6d46469c.js";import{M as ie,F as ce,a as oe,b as de,c as me,d as pe,e as he,f as ue}from"./react-icons-1e0e0cbd.js";import{u as M,a as R,P as xe}from"./react-redux-97e9511e.js";import{c as ge,a as fe}from"./@reduxjs-6db8dec8.js";import{i as je,G as be,g as Ne,s as ye,a as q,b as z,u as J,c as G}from"./@firebase-7dc404e9.js";import"./firebase-cf757237.js";import"./hoist-non-react-statics-178b73a1.js";import{a as T,O as we,d as ve,e as Z,f as Se,g as F}from"./react-router-9ac737c6.js";import{a as Ue}from"./axios-21b846bc.js";import{p as ke,a as Ce,d as Le,P as Pe}from"./redux-persist-2cefc396.js";import{c as Fe}from"./redux-cf6e261f.js";import"./scheduler-765c72db.js";import"./@remix-run-d753ad9e.js";import"./use-sync-external-store-c2187ad8.js";import"./immer-41fd5235.js";import"./redux-thunk-ef899f4c.js";import"./tslib-6635c9de.js";import"./idb-81bdbf9b.js";import"./react-is-e8e5dbb3.js";import"./@babel-209e909a.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const t of a)if(t.type==="childList")for(const n of t.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&o(n)}).observe(document,{childList:!0,subtree:!0});function m(a){const t={};return a.integrity&&(t.integrity=a.integrity),a.referrerPolicy&&(t.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?t.credentials="include":a.crossOrigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(a){if(a.ep)return;a.ep=!0;const t=m(a);fetch(a.href,t)}})();function E({listing:s}){return e.jsx("div",{className:"bg-white shadow-md hover:shadow-lg transition-shadow overflow-hidden rounded-lg w-full sm:w-[330px]",children:e.jsxs(U,{to:`/listing/${s._id}`,children:[e.jsx("img",{src:s.imageUrls[0]||"https://53.fs1.hubspotusercontent-na1.net/hub/53/hubfs/Sales_Blog/real-estate-business-compressor.jpg?width=595&height=400&name=real-estate-business-compressor.jpg",alt:"listing cover",className:"h-[320px] sm:h-[220px] w-full object-cover hover:scale-105 transition-scale duration-300"}),e.jsxs("div",{className:"p-3 flex flex-col gap-2 w-full",children:[e.jsx("p",{className:"truncate text-lg font-semibold text-slate-700",children:s.name}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"h-4 w-4 text-green-700"}),e.jsx("p",{className:"text-sm text-gray-600 truncate w-full",children:s.address})]}),e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:s.description}),e.jsxs("p",{className:"text-slate-500 mt-2 font-semibold ",children:["$",s.offer?s.discountPrice.toLocaleString("en-US"):s.regularPrice.toLocaleString("en-US"),s.type==="rent"&&" / month"]}),e.jsxs("div",{className:"text-slate-700 flex gap-4",children:[e.jsx("div",{className:"font-bold text-xs",children:s.bedrooms>1?`${s.bedrooms} beds `:`${s.bedrooms} bed `}),e.jsx("div",{className:"font-bold text-xs",children:s.bathrooms>1?`${s.bathrooms} baths `:`${s.bathrooms} bath `})]})]})]})})}function Re(){const[s,r]=i.useState([]),[m,o]=i.useState([]),[a,t]=i.useState([]);return W.use([V]),console.log(s),i.useEffect(()=>{const n=async()=>{try{const g=await(await fetch("https://real-estate-nemg.onrender.com/api/listing/get?offer=true&limit=4")).json();r(g),j()}catch(p){console.log(p)}},j=async()=>{try{const g=await(await fetch("https://real-estate-nemg.onrender.com/api/listing/get?type=rent&limit=4")).json();t(g),x()}catch(p){console.log(p)}},x=async()=>{try{const g=await(await fetch("https://real-estate-nemg.onrender.com/api/listing/get?type=sale&limit=4")).json();o(g)}catch(p){log(p)}};n()},[]),e.jsxs("div",{children:[e.jsxs("div",{className:"flex flex-col gap-6 p-28 px-3 max-w-6xl mx-auto",children:[e.jsxs("h1",{className:"text-slate-700 font-bold text-3xl lg:text-6xl",children:["Find your next ",e.jsx("span",{className:"text-slate-500",children:"perfect"}),e.jsx("br",{}),"place with ease"]}),e.jsxs("div",{className:"text-gray-400 text-xs sm:text-sm",children:["Mega Estate is the best place to find your next perfect place to live.",e.jsx("br",{}),"We have a wide range of properties for you to choose from."]}),e.jsx(U,{to:"/search",className:"text-xs sm:text-sm text-blue-800 font-bold hover:underline",children:"Let's get started..."})]}),e.jsx(K,{navigation:!0,children:s&&s.length>0&&s.map(n=>e.jsx(X,{children:e.jsx("div",{style:{background:`url(${n.imageUrls[0]}) center no-repeat`,backgroundSize:"cover"},className:"h-[500px]"},n._id)}))}),e.jsxs("div",{className:"max-w-6xl mx-auto p-3 flex flex-col gap-8 my-10",children:[s&&s.length>0&&e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"my-3",children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-600",children:"Recent offers"}),e.jsx(U,{className:"text-sm text-blue-800 hover:underline",to:"/search?offer=true",children:"Show more offers"})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:s.map(n=>e.jsx(E,{listing:n},n._id))})]}),a&&a.length>0&&e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"my-3",children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-600",children:"Recent places for rent"}),e.jsx(U,{className:"text-sm text-blue-800 hover:underline",to:"/search?type=rent",children:"Show more places for rent"})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:a.map(n=>e.jsx(E,{listing:n},n._id))})]}),m&&m.length>0&&e.jsxs("div",{className:"",children:[e.jsxs("div",{className:"my-3",children:[e.jsx("h2",{className:"text-2xl font-semibold text-slate-600",children:"Recent places for sale"}),e.jsx(U,{className:"text-sm text-blue-800 hover:underline",to:"/search?type=sale",children:"Show more places for sale"})]}),e.jsx("div",{className:"flex flex-wrap gap-4",children:m.map(n=>e.jsx(E,{listing:n},n._id))})]})]})]})}const Te={currentUser:null,error:null,loading:!1},ee=ge({name:"user",initialState:Te,reducers:{signInStart:s=>{s.loading=!0},signInSuccess:(s,r)=>{s.currentUser=r.payload,s.loading=!1,s.error=null},signInFailure:(s,r)=>{s.error=r.payload,s.loading=!1},updateUserStart:s=>{s.loading=!0},updateUserSuccess:(s,r)=>{s.currentUser=r.payload,s.loading=!1,s.error=null},updateUserFailure:(s,r)=>{s.error=r.payload,s.loading=!1},deleteUserStart:s=>{s.loading=!0},deleteUserSuccess:s=>{s.currentUser=null,s.loading=!1,s.error=null},deleteUserFailure:(s,r)=>{s.error=r.payload,s.loading=!1},signOutUserStart:s=>{s.loading=!0},signOutUserSuccess:s=>{s.currentUser=null,s.loading=!1,s.error=null},signOutUserFailure:(s,r)=>{s.error=r.payload,s.loading=!1}}}),{signInStart:$e,signInSuccess:se,signInFailure:Y,updateUserFailure:H,updateUserSuccess:Ie,updateUserStart:Oe,deleteUserFailure:_,deleteUserSuccess:Q,deleteUserStart:De,signOutUserFailure:Us,signOutUserSuccess:ks,signOutUserStart:_e}=ee.actions,Ee=ee.reducer,Ae={apiKey:"AIzaSyBkMrJNIDuAaw02yf5iC6mediran6xTuL0",authDomain:"ashish-37c96.firebaseapp.com",projectId:"ashish-37c96",storageBucket:"ashish-37c96.appspot.com",messagingSenderId:"424879060074",appId:"1:424879060074:web:239bb0cf940c0573574613",measurementId:"G-4NJNPE5RL8"},A=je(Ae);function te(){const s=M(),r=T(),m=async()=>{try{const o=new be,a=Ne(A),t=await ye(a,o),j=await(await fetch("https://real-estate-nemg.onrender.com/api/auth/google",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:t.user.displayName,email:t.user.email,photo:t.user.photoURL})})).json();s(se(j)),r("/")}catch(o){console.log("could not sign in with google",o)}};return e.jsx("button",{onClick:m,type:"button",className:"bg-red-700 text-white p-3 rounded-lg uppercase hover:opacity-95",children:"Continue with google"})}function Be(){const[s,r]=i.useState({}),{loading:m,error:o}=R(x=>x.user),a=T(),t=M(),n=x=>{r({...s,[x.target.id]:x.target.value})},j=async x=>{x.preventDefault();try{t($e());const g=await(await fetch("https://real-estate-nemg.onrender.com/api/auth/signin",{method:"POST",mode:"cors",withCredentials:!0,cache:"no-cache",credentials:"include",redirect:"follow",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json();if(console.log(g),g.success===!1){t(Y(g.message));return}t(se(g)),a("/")}catch(p){t(Y(p.message))}};return e.jsxs("div",{className:"p-3 max-w-lg mx-auto",children:[e.jsx("h1",{className:"text-3xl text-center font-semibold my-7",children:"Sign In"}),e.jsxs("form",{onSubmit:j,className:"flex flex-col gap-4",children:[e.jsx("input",{type:"email",placeholder:"email",className:"border p-3 rounded-lg",id:"email",onChange:n}),e.jsx("input",{type:"password",placeholder:"password",className:"border p-3 rounded-lg",id:"password",onChange:n}),e.jsx("button",{disabled:m,className:"bg-slate-700 text-white p-3 rounded-lg uppercase hover:opacity-95 disabled:opacity-80",children:m?"Loading...":"Sign In"}),e.jsx(te,{})]}),e.jsxs("div",{className:"flex gap-2 mt-5",children:[e.jsx("p",{children:"Dont have an account?"}),e.jsx(U,{to:"/sign-up",children:e.jsx("span",{className:"text-blue-700",children:"Sign up"})})]}),o&&e.jsx("p",{className:"text-red-500 mt-5",children:o})]})}function Me(){const[s,r]=i.useState({}),[m,o]=i.useState(null),[a,t]=i.useState(!1),n=T(),j=p=>{r({...s,[p.target.id]:p.target.value})},x=async p=>{p.preventDefault();try{t(!0);const w=await(await Ue("https://real-estate-nemg.onrender.com/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).json();if(console.log(w),w.success===!1){t(!1),o(w.message);return}t(!1),o(null),n("/sign-in")}catch(g){t(!1),o(g.message)}};return e.jsxs("div",{className:"p-3 max-w-lg mx-auto",children:[e.jsx("h1",{className:"text-3xl text-center font-semibold my-7",children:"Sign Up"}),e.jsxs("form",{onSubmit:x,className:"flex flex-col gap-4",children:[e.jsx("input",{type:"text",placeholder:"username",className:"border p-3 rounded-lg",id:"username",onChange:j}),e.jsx("input",{type:"email",placeholder:"email",className:"border p-3 rounded-lg",id:"email",onChange:j}),e.jsx("input",{type:"password",placeholder:"password",className:"border p-3 rounded-lg",id:"password",onChange:j}),e.jsx("button",{disabled:a,className:"bg-slate-700 text-white p-3 rounded-lg uppercase hover:opacity-95 disabled:opacity-80",children:a?"Loading...":"Sign Up"}),e.jsx(te,{})]}),e.jsxs("div",{className:"flex gap-2 mt-5",children:[e.jsx("p",{children:"Have an account?"}),e.jsx(U,{to:"/sign-in",children:e.jsx("span",{className:"text-blue-700",children:"Sign in"})})]}),m&&e.jsx("p",{className:"text-red-500 mt-5",children:m})]})}function qe(){return e.jsxs("div",{className:"py-20 px-4 max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-bold mb-4 text-slate-800",children:"About Mega Estate"}),e.jsx("p",{className:"mb-4 text-slate-700",children:"Mega Estate is a leading real estate agency that specializes in helping clients buy, sell, and rent properties in the most desirable neighborhoods. Our team of experienced agents is dedicated to providing exceptional service and making the buying and selling process as smooth as possible."}),e.jsx("p",{className:"mb-4 text-slate-700",children:"Our mission is to help our clients achieve their real estate goals by providing expert advice, personalized service, and a deep understanding of the local market. Whether you are looking to buy, sell, or rent a property, we are here to help you every step of the way."}),e.jsx("p",{className:"mb-4 text-slate-700",children:"Our team of agents has a wealth of experience and knowledge in the real estate industry, and we are committed to providing the highest level of service to our clients. We believe that buying or selling a property should be an exciting and rewarding experience, and we are dedicated to making that a reality for each and every one of our clients."})]})}function ze(){const s=i.useRef(null),{currentUser:r,loading:m,error:o}=R(d=>d.user),[a,t]=i.useState(void 0),[n,j]=i.useState(0),[x,p]=i.useState(!1),[g,w]=i.useState({}),[l,N]=i.useState(!1),[v,k]=i.useState(!1),[L,y]=i.useState([]),f=M();i.useEffect(()=>{a&&h(a)},[a]);const h=d=>{const b=q(A),P=new Date().getTime()+d.name,B=z(b,P),D=J(B,d);D.on("state_changed",O=>{const re=O.bytesTransferred/O.totalBytes*100;j(Math.round(re))},O=>{p(!0)},()=>{G(D.snapshot.ref).then(O=>w({...g,avatar:O}))})},c=d=>{w({...g,[d.target.id]:d.target.value})},u=async d=>{d.preventDefault();try{f(Oe());const P=await(await fetch(`https://real-estate-nemg.onrender.com/api/user/update/${r._id}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(g)})).json();if(P.success===!1){f(H(P.message));return}f(Ie(P)),N(!0)}catch(b){f(H(b.message))}},S=async()=>{try{f(De());const b=await(await fetch(`https://real-estate-nemg.onrender.com/api/user/delete/${r._id}`,{method:"DELETE"})).json();if(b.success===!1){f(_(b.message));return}f(Q(b))}catch(d){f(_(d.message))}},C=async()=>{try{f(_e());const b=await(await fetch("https://real-estate-nemg.onrender.com/api/auth/signout")).json();if(b.success===!1){f(_(b.message));return}f(Q(b))}catch{f(_(data.message))}},I=async()=>{try{k(!1);const b=await(await fetch(`https://real-estate-nemg.onrender.com/api/user/listings/${r._id}`)).json();if(b.success===!1){k(!0);return}y(b)}catch{k(!0)}},$=async d=>{try{const P=await(await fetch(`https://real-estate-nemg.onrender.com/api/listing/delete/${d}`,{method:"DELETE"})).json();if(P.success===!1){console.log(P.message);return}y(B=>B.filter(D=>D._id!==d))}catch(b){console.log(b.message)}};return e.jsxs("div",{className:"p-3 max-w-lg mx-auto",children:[e.jsx("h1",{className:"text-3xl font-semibold text-center my-7",children:"Profile"}),e.jsxs("form",{onSubmit:u,className:"flex flex-col gap-4",children:[e.jsx("input",{onChange:d=>t(d.target.files[0]),type:"file",ref:s,hidden:!0,accept:"image/*"}),e.jsx("img",{onClick:()=>s.current.click(),src:g.avatar||r.avatar,alt:"profile",className:"rounded-full h-24 w-24 object-cover cursor-pointer self-center mt-2"}),e.jsx("p",{className:"text-sm self-center",children:x?e.jsx("span",{className:"text-red-700",children:"Error Image upload (image must be less than 2 mb)"}):n>0&&n<100?e.jsx("span",{className:"text-slate-700",children:`Uploading ${n}%`}):n===100?e.jsx("span",{className:"text-green-700",children:"Image successfully uploaded!"}):""}),e.jsx("input",{type:"text",placeholder:"username",defaultValue:r.username,id:"username",className:"border p-3 rounded-lg",onChange:c}),e.jsx("input",{type:"email",placeholder:"email",id:"email",defaultValue:r.email,className:"border p-3 rounded-lg",onChange:c}),e.jsx("input",{type:"password",placeholder:"password",onChange:c,id:"password",className:"border p-3 rounded-lg"}),e.jsx("button",{disabled:m,className:"bg-slate-700 text-white rounded-lg p-3 uppercase hover:opacity-95 disabled:opacity-80",children:m?"Loading...":"Update"}),e.jsx(U,{className:"bg-green-700 text-white p-3 rounded-lg uppercase text-center hover:opacity-95",to:"/create-listing",children:"Create Listing"})]}),e.jsxs("div",{className:"flex justify-between mt-5",children:[e.jsx("span",{onClick:S,className:"text-red-700 cursor-pointer",children:"Delete account"}),e.jsx("span",{onClick:C,className:"text-red-700 cursor-pointer",children:"Sign out"})]}),e.jsx("p",{className:"text-red-700 mt-5",children:o||""}),e.jsx("p",{className:"text-green-700 mt-5",children:l?"User is updated successfully!":""}),e.jsx("button",{onClick:I,className:"text-green-700 w-full",children:"Show Listings"}),e.jsx("p",{className:"text-red-700 mt-5",children:v?"Error showing listings":""}),L&&L.length>0&&e.jsxs("div",{className:"flex flex-col gap-4",children:[e.jsx("h1",{className:"text-center mt-7 text-2xl font-semibold",children:"Your Listings"}),L.map(d=>e.jsxs("div",{className:"border rounded-lg p-3 flex justify-between items-center gap-4",children:[e.jsx(U,{to:`/listing/${d._id}`,children:e.jsx("img",{src:d.imageUrls[0],alt:"listing cover",className:"h-16 w-16 object-contain"})}),e.jsx(U,{className:"text-slate-700 font-semibold  hover:underline truncate flex-1",to:`/listing/${d._id}`,children:e.jsx("p",{children:d.name})}),e.jsxs("div",{className:"flex flex-col item-center",children:[e.jsx("button",{onClick:()=>$(d._id),className:"text-red-700 uppercase",children:"Delete"}),e.jsx(U,{to:`/update-listing/${d._id}`,children:e.jsx("button",{className:"text-green-700 uppercase",children:"Edit"})})]})]},d._id))]})]})}function Je(){const{currentUser:s}=R(t=>t.user),[r,m]=i.useState(""),o=T(),a=t=>{t.preventDefault();const n=new URLSearchParams(window.location.search);n.set("searchTerm",r);const j=n.toString();o(`/search?${j}`)};return i.useEffect(()=>{const n=new URLSearchParams(location.search).get("searchTerm");n&&m(n)},[location.search]),e.jsx("header",{className:"bg-slate-200 shadow-md",children:e.jsxs("div",{className:"flex justify-between items-center max-w-6xl mx-auto p-3",children:[e.jsx(U,{to:"/",children:e.jsxs("h1",{className:"font-bold text-sm sm:text-xl flex flex-wrap",children:[e.jsx("span",{className:"text-slate-500",children:"Mega"}),e.jsx("span",{className:"text-slate-700",children:"Estate"})]})}),e.jsxs("form",{onSubmit:a,className:"bg-slate-100 p-3 rounded-lg flex items-center",children:[e.jsx("input",{type:"text",placeholder:"Search...",className:"bg-transparent focus:outline-none w-24 sm:w-64",value:r,onChange:t=>m(t.target.value)}),e.jsx("button",{children:e.jsx(ce,{className:"text-slate-600"})})]}),e.jsxs("ul",{className:"flex gap-4",children:[e.jsx(U,{to:"/",children:e.jsx("li",{className:"hidden sm:inline text-slate-700 hover:underline",children:"Home"})}),e.jsx(U,{to:"/about",children:e.jsx("li",{className:"hidden sm:inline text-slate-700 hover:underline",children:"About"})}),e.jsx(U,{to:"/profile",children:s?e.jsx("img",{className:"rounded-full h-7 w-7 object-cover",src:s.avatar,alt:"profile"}):e.jsx("li",{className:" text-slate-700 hover:underline",children:" Sign in"})})]})]})})}function Ge(){const{currentUser:s}=R(r=>r.user);return s?e.jsx(we,{}):e.jsx(ve,{to:"/sign-in"})}function Ye(){const{currentUser:s}=R(h=>h.user),r=T(),[m,o]=i.useState([]),[a,t]=i.useState({imageUrls:[],name:"",description:"",address:"",type:"rent",bedrooms:1,bathrooms:1,regularPrice:50,discountPrice:0,offer:!1,parking:!1,furnished:!1}),[n,j]=i.useState(!1),[x,p]=i.useState(!1),[g,w]=i.useState(!1),[l,N]=i.useState(!1);console.log(a);const v=h=>{if(m.length>0&&m.length+a.imageUrls.length<7){p(!0),j(!1);const c=[];for(let u=0;u<m.length;u++)c.push(k(m[u]));Promise.all(c).then(u=>{t({...a,imageUrls:a.imageUrls.concat(u)}),j(!1),p(!1)}).catch(u=>{j("Image upload failed (2 mb max per image)"),p(!1)})}else j("You can only upload 6 images per listing"),p(!1)},k=async h=>new Promise((c,u)=>{const S=q(A),C=new Date().getTime()+h.name,I=z(S,C),$=J(I,h);$.on("state_changed",d=>{const b=d.bytesTransferred/d.totalBytes*100;console.log(`Upload is ${b}% done`)},d=>{u(d)},()=>{G($.snapshot.ref).then(d=>{c(d)})})}),L=h=>{t({...a,imageUrls:a.imageUrls.filter((c,u)=>u!==h)})},y=h=>{(h.target.id==="sale"||h.target.id==="rent")&&t({...a,type:h.target.id}),(h.target.id==="parking"||h.target.id==="furnished"||h.target.id==="offer")&&t({...a,[h.target.id]:h.target.checked}),(h.target.type==="number"||h.target.type==="text"||h.target.type==="textarea")&&t({...a,[h.target.id]:h.target.value})},f=async h=>{h.preventDefault();try{if(a.imageUrls.length<1)return w("You must upload at least one image");if(+a.regularPrice<+a.discountPrice)return w("Discount price must be lower than regular price");N(!0),w(!1);const u=await(await fetch("https://real-estate-nemg.onrender.com/api/listing/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...a,userRef:s._id})})).json();console.log(u),N(!1),u.success===!1&&w(u.message),r(`/listing/${u._id}`)}catch(c){w(c.message),N(!1)}};return e.jsxs("main",{className:"p-3 max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-semibold text-center my-7",children:"Create a Listing"}),e.jsxs("form",{onSubmit:f,className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 flex-1",children:[e.jsx("input",{type:"text",placeholder:"Name",className:"border p-3 rounded-lg",id:"name",maxLength:"62",minLength:"10",required:!0,onChange:y,value:a.name}),e.jsx("textarea",{type:"text",placeholder:"Description",className:"border p-3 rounded-lg",id:"description",required:!0,onChange:y,value:a.description}),e.jsx("input",{type:"text",placeholder:"Address",className:"border p-3 rounded-lg",id:"address",required:!0,onChange:y,value:a.address}),e.jsxs("div",{className:"flex gap-6 flex-wrap",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"sale",className:"w-5",onChange:y,checked:a.type==="sale"}),e.jsx("span",{children:"Sell"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"rent",className:"w-5",onChange:y,checked:a.type==="rent"}),e.jsx("span",{children:"Rent"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"parking",className:"w-5",onChange:y,checked:a.parking}),e.jsx("span",{children:"Parking spot"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"furnished",className:"w-5",onChange:y,checked:a.furnished}),e.jsx("span",{children:"Furnished"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"offer",className:"w-5",onChange:y,checked:a.offer}),e.jsx("span",{children:"Offer"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",id:"bedrooms",min:"1",max:"10",required:!0,className:"p-3 border border-gray-300 rounded-lg",onChange:y,value:a.bedrooms}),e.jsx("p",{children:"Beds"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",id:"bathrooms",min:"1",max:"10",required:!0,className:"p-3 border border-gray-300 rounded-lg",onChange:y,value:a.bathrooms}),e.jsx("p",{children:"Baths"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",id:"regularPrice",min:"50",max:"10000000",required:!0,className:"p-3 border border-gray-300 rounded-lg",onChange:y,value:a.regularPrice}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("p",{children:"Regular price"}),a.type==="rent"&&e.jsx("span",{className:"text-xs",children:"($ / month)"})]})]}),a.offer&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",id:"discountPrice",min:"0",max:"10000000",required:!0,className:"p-3 border border-gray-300 rounded-lg",onChange:y,value:a.discountPrice}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("p",{children:"Discounted price"}),a.type==="rent"&&e.jsx("span",{className:"text-xs",children:"($ / month)"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col flex-1 gap-4",children:[e.jsxs("p",{className:"font-semibold",children:["Images:",e.jsx("span",{className:"font-normal text-gray-600 ml-2",children:"The first image will be the cover (max 6)"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{onChange:h=>o(h.target.files),className:"p-3 border border-gray-300 rounded w-full",type:"file",id:"images",accept:"image/*",multiple:!0}),e.jsx("button",{type:"button",disabled:x,onClick:v,className:"p-3 text-green-700 border border-green-700 rounded uppercase hover:shadow-lg disabled:opacity-80",children:x?"Uploading...":"Upload"})]}),e.jsx("p",{className:"text-red-700 text-sm",children:n&&n}),a.imageUrls.length>0&&a.imageUrls.map((h,c)=>e.jsxs("div",{className:"flex justify-between p-3 border items-center",children:[e.jsx("img",{src:h,alt:"listing image",className:"w-20 h-20 object-contain rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>L(c),className:"p-3 text-red-700 rounded-lg uppercase hover:opacity-75",children:"Delete"})]},h)),e.jsx("button",{disabled:l||x,className:"p-3 bg-slate-700 text-white rounded-lg uppercase hover:opacity-95 disabled:opacity-80",children:l?"Creating...":"Create listing"}),g&&e.jsx("p",{className:"text-red-700 text-sm",children:g})]})]})]})}function He(){const{currentUser:s}=R(c=>c.user),r=T(),m=Z(),[o,a]=i.useState([]),[t,n]=i.useState({imageUrls:[],name:"",description:"",address:"",type:"rent",bedrooms:1,bathrooms:1,regularPrice:50,discountPrice:0,offer:!1,parking:!1,furnished:!1}),[j,x]=i.useState(!1),[p,g]=i.useState(!1),[w,l]=i.useState(!1),[N,v]=i.useState(!1);i.useEffect(()=>{(async()=>{const u=m.listingId,C=await(await fetch(`https://real-estate-nemg.onrender.com/api/listing/get/${u}`)).json();if(C.success===!1){console.log(C.message);return}n(C)})()},[]);const k=c=>{if(o.length>0&&o.length+t.imageUrls.length<7){g(!0),x(!1);const u=[];for(let S=0;S<o.length;S++)u.push(L(o[S]));Promise.all(u).then(S=>{n({...t,imageUrls:t.imageUrls.concat(S)}),x(!1),g(!1)}).catch(S=>{x("Image upload failed (2 mb max per image)"),g(!1)})}else x("You can only upload 6 images per listing"),g(!1)},L=async c=>new Promise((u,S)=>{const C=q(A),I=new Date().getTime()+c.name,$=z(C,I),d=J($,c);d.on("state_changed",b=>{const P=b.bytesTransferred/b.totalBytes*100;console.log(`Upload is ${P}% done`)},b=>{S(b)},()=>{G(d.snapshot.ref).then(b=>{u(b)})})}),y=c=>{n({...t,imageUrls:t.imageUrls.filter((u,S)=>S!==c)})},f=c=>{(c.target.id==="sale"||c.target.id==="rent")&&n({...t,type:c.target.id}),(c.target.id==="parking"||c.target.id==="furnished"||c.target.id==="offer")&&n({...t,[c.target.id]:c.target.checked}),(c.target.type==="number"||c.target.type==="text"||c.target.type==="textarea")&&n({...t,[c.target.id]:c.target.value})},h=async c=>{c.preventDefault();try{if(t.imageUrls.length<1)return l("You must upload at least one image");if(+t.regularPrice<+t.discountPrice)return l("Discount price must be lower than regular price");v(!0),l(!1);const S=await(await fetch(`https://real-estate-nemg.onrender.com/api/listing/update/${m.listingId}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...t,userRef:s._id})})).json();v(!1),S.success===!1&&l(S.message),r(`/listing/${S._id}`)}catch(u){l(u.message),v(!1)}};return e.jsxs("main",{className:"p-3 max-w-4xl mx-auto",children:[e.jsx("h1",{className:"text-3xl font-semibold text-center my-7",children:"Update a Listing"}),e.jsxs("form",{onSubmit:h,className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex flex-col gap-4 flex-1",children:[e.jsx("input",{type:"text",placeholder:"Name",className:"border p-3 rounded-lg",id:"name",maxLength:"62",minLength:"10",required:!0,onChange:f,value:t.name}),e.jsx("textarea",{type:"text",placeholder:"Description",className:"border p-3 rounded-lg",id:"description",required:!0,onChange:f,value:t.description}),e.jsx("input",{type:"text",placeholder:"Address",className:"border p-3 rounded-lg",id:"address",required:!0,onChange:f,value:t.address}),e.jsxs("div",{className:"flex gap-6 flex-wrap",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"sale",className:"w-5",onChange:f,checked:t.type==="sale"}),e.jsx("span",{children:"Sell"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"rent",className:"w-5",onChange:f,checked:t.type==="rent"}),e.jsx("span",{children:"Rent"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"parking",className:"w-5",onChange:f,checked:t.parking}),e.jsx("span",{children:"Parking spot"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"furnished",className:"w-5",onChange:f,checked:t.furnished}),e.jsx("span",{children:"Furnished"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"offer",className:"w-5",onChange:f,checked:t.offer}),e.jsx("span",{children:"Offer"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-6",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",id:"bedrooms",min:"1",max:"10",required:!0,className:"p-3 border border-gray-300 rounded-lg",onChange:f,value:t.bedrooms}),e.jsx("p",{children:"Beds"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",id:"bathrooms",min:"1",max:"10",required:!0,className:"p-3 border border-gray-300 rounded-lg",onChange:f,value:t.bathrooms}),e.jsx("p",{children:"Baths"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",id:"regularPrice",min:"50",max:"10000000",required:!0,className:"p-3 border border-gray-300 rounded-lg",onChange:f,value:t.regularPrice}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("p",{children:"Regular price"}),t.type==="rent"&&e.jsx("span",{className:"text-xs",children:"($ / month)"})]})]}),t.offer&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"number",id:"discountPrice",min:"0",max:"10000000",required:!0,className:"p-3 border border-gray-300 rounded-lg",onChange:f,value:t.discountPrice}),e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("p",{children:"Discounted price"}),t.type==="rent"&&e.jsx("span",{className:"text-xs",children:"($ / month)"})]})]})]})]}),e.jsxs("div",{className:"flex flex-col flex-1 gap-4",children:[e.jsxs("p",{className:"font-semibold",children:["Images:",e.jsx("span",{className:"font-normal text-gray-600 ml-2",children:"The first image will be the cover (max 6)"})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("input",{onChange:c=>a(c.target.files),className:"p-3 border border-gray-300 rounded w-full",type:"file",id:"images",accept:"image/*",multiple:!0}),e.jsx("button",{type:"button",disabled:p,onClick:k,className:"p-3 text-green-700 border border-green-700 rounded uppercase hover:shadow-lg disabled:opacity-80",children:p?"Uploading...":"Upload"})]}),e.jsx("p",{className:"text-red-700 text-sm",children:j&&j}),t.imageUrls.length>0&&t.imageUrls.map((c,u)=>e.jsxs("div",{className:"flex justify-between p-3 border items-center",children:[e.jsx("img",{src:c,alt:"listing image",className:"w-20 h-20 object-contain rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>y(u),className:"p-3 text-red-700 rounded-lg uppercase hover:opacity-75",children:"Delete"})]},c)),e.jsx("button",{disabled:N||p,className:"p-3 bg-slate-700 text-white rounded-lg uppercase hover:opacity-95 disabled:opacity-80",children:N?"Updating...":"Update listing"}),w&&e.jsx("p",{className:"text-red-700 text-sm",children:w})]})]})]})}function Qe({listing:s}){const[r,m]=i.useState(null),[o,a]=i.useState(""),t=n=>{a(n.target.value)};return i.useEffect(()=>{(async()=>{try{const x=await(await fetch(`https://real-estate-nemg.onrender.com/api/user/${s.userRef}`)).json();m(x)}catch(j){console.log(j)}})()},[s.userRef]),e.jsx(e.Fragment,{children:r&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("p",{children:["Contact ",e.jsx("span",{className:"font-semibold",children:r.username})," ","for"," ",e.jsx("span",{className:"font-semibold",children:s.name.toLowerCase()})]}),e.jsx("textarea",{name:"message",id:"message",rows:"2",value:o,onChange:t,placeholder:"Enter your message here...",className:"w-full border p-3 rounded-lg"}),e.jsx(U,{to:`mailto:${r.email}?subject=Regarding ${s.name}&body=${o}`,className:"bg-slate-700 text-white text-center p-3 uppercase rounded-lg hover:opacity-95",children:"Send Message"})]})})}function We(){W.use([V]);const[s,r]=i.useState(null),[m,o]=i.useState(!1),[a,t]=i.useState(!1),[n,j]=i.useState(!1),[x,p]=i.useState(!1),g=Z(),{currentUser:w}=R(l=>l.user);return i.useEffect(()=>{(async()=>{try{o(!0);const v=await(await fetch(`https://real-estate-nemg.onrender.com/api/listing/get/${g.listingId}`)).json();if(v.success===!1){t(!0),o(!1);return}r(v),o(!1),t(!1)}catch{t(!0),o(!1)}})()},[g.listingId]),e.jsxs("main",{children:[m&&e.jsx("p",{className:"text-center my-7 text-2xl",children:"Loading..."}),a&&e.jsx("p",{className:"text-center my-7 text-2xl",children:"Something went wrong!"}),s&&!m&&!a&&e.jsxs("div",{children:[e.jsx(K,{navigation:!0,children:s.imageUrls.map(l=>e.jsx(X,{children:e.jsx("div",{className:"h-[550px]",style:{background:`url(${l}) center no-repeat`,backgroundSize:"cover"}})},l))}),e.jsx("div",{className:"fixed top-[13%] right-[3%] z-10 border rounded-full w-12 h-12 flex justify-center items-center bg-slate-100 cursor-pointer",children:e.jsx(oe,{className:"text-slate-500",onClick:()=>{navigator.clipboard.writeText(window.location.href),j(!0),setTimeout(()=>{j(!1)},2e3)}})}),n&&e.jsx("p",{className:"fixed top-[23%] right-[5%] z-10 rounded-md bg-slate-100 p-2",children:"Link copied!"}),e.jsxs("div",{className:"flex flex-col max-w-4xl mx-auto p-3 my-7 gap-4",children:[e.jsxs("p",{className:"text-2xl font-semibold",children:[s.name," - $"," ",s.offer?s.discountPrice.toLocaleString("en-US"):s.regularPrice.toLocaleString("en-US"),s.type==="rent"&&" / month"]}),e.jsxs("p",{className:"flex items-center mt-6 gap-2 text-slate-600  text-sm",children:[e.jsx(de,{className:"text-green-700"}),s.address]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("p",{className:"bg-red-900 w-full max-w-[200px] text-white text-center p-1 rounded-md",children:s.type==="rent"?"For Rent":"For Sale"}),s.offer&&e.jsxs("p",{className:"bg-green-900 w-full max-w-[200px] text-white text-center p-1 rounded-md",children:["$",+s.regularPrice-+s.discountPrice," OFF"]})]}),e.jsxs("p",{className:"text-slate-800",children:[e.jsx("span",{className:"font-semibold text-black",children:"Description - "}),s.description]}),e.jsxs("ul",{className:"text-green-900 font-semibold text-sm flex flex-wrap items-center gap-4 sm:gap-6",children:[e.jsxs("li",{className:"flex items-center gap-1 whitespace-nowrap ",children:[e.jsx(me,{className:"text-lg"}),s.bedrooms>1?`${s.bedrooms} beds `:`${s.bedrooms} bed `]}),e.jsxs("li",{className:"flex items-center gap-1 whitespace-nowrap ",children:[e.jsx(pe,{className:"text-lg"}),s.bathrooms>1?`${s.bathrooms} baths `:`${s.bathrooms} bath `]}),e.jsxs("li",{className:"flex items-center gap-1 whitespace-nowrap ",children:[e.jsx(he,{className:"text-lg"}),s.parking?"Parking spot":"No Parking"]}),e.jsxs("li",{className:"flex items-center gap-1 whitespace-nowrap ",children:[e.jsx(ue,{className:"text-lg"}),s.furnished?"Furnished":"Unfurnished"]})]}),w&&s.userRef!==w._id&&!x&&e.jsx("button",{onClick:()=>p(!0),className:"bg-slate-700 text-white rounded-lg uppercase hover:opacity-95 p-3",children:"Contact landlord"}),x&&e.jsx(Qe,{listing:s})]})]})]})}function Ve(){const s=T(),[r,m]=i.useState({searchTerm:"",type:"all",parking:!1,furnished:!1,offer:!1,sort:"created_at",order:"desc"}),[o,a]=i.useState(!1),[t,n]=i.useState([]),[j,x]=i.useState(!1);i.useEffect(()=>{const l=new URLSearchParams(location.search),N=l.get("searchTerm"),v=l.get("type"),k=l.get("parking"),L=l.get("furnished"),y=l.get("offer"),f=l.get("sort"),h=l.get("order");(N||v||k||L||y||f||h)&&m({searchTerm:N||"",type:v||"all",parking:k==="true",furnished:L==="true",offer:y==="true",sort:f||"created_at",order:h||"desc"}),(async()=>{a(!0),x(!1);const u=l.toString(),C=await(await fetch(`https://real-estate-nemg.onrender.com/api/listing/get?${u}`)).json();C.length>8?x(!0):x(!1),n(C),a(!1)})()},[location.search]);const p=l=>{if((l.target.id==="all"||l.target.id==="rent"||l.target.id==="sale")&&m({...r,type:l.target.id}),l.target.id==="searchTerm"&&m({...r,searchTerm:l.target.value}),(l.target.id==="parking"||l.target.id==="furnished"||l.target.id==="offer")&&m({...r,[l.target.id]:!!(l.target.checked||l.target.checked==="true")}),l.target.id==="sort_order"){const N=l.target.value.split("_")[0]||"created_at",v=l.target.value.split("_")[1]||"desc";m({...r,sort:N,order:v})}},g=l=>{l.preventDefault();const N=new URLSearchParams;N.set("searchTerm",r.searchTerm),N.set("type",r.type),N.set("parking",r.parking),N.set("furnished",r.furnished),N.set("offer",r.offer),N.set("sort",r.sort),N.set("order",r.order);const v=N.toString();s(`/search?${v}`)},w=async()=>{const N=t.length,v=new URLSearchParams(location.search);v.set("startIndex",N);const k=v.toString(),y=await(await fetch(`/api/listing/get?${k}`)).json();y.length<9&&x(!1),n([...t,...y])};return e.jsxs("div",{className:"flex flex-col md:flex-row",children:[e.jsx("div",{className:"p-7  border-b-2 md:border-r-2 md:min-h-screen",children:e.jsxs("form",{onSubmit:g,className:"flex flex-col gap-8",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"whitespace-nowrap font-semibold",children:"Search Term:"}),e.jsx("input",{type:"text",id:"searchTerm",placeholder:"Search...",className:"border rounded-lg p-3 w-full",value:r.searchTerm,onChange:p})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[e.jsx("label",{className:"font-semibold",children:"Type:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"all",className:"w-5",onChange:p,checked:r.type==="all"}),e.jsx("span",{children:"Rent & Sale"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"rent",className:"w-5",onChange:p,checked:r.type==="rent"}),e.jsx("span",{children:"Rent"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"sale",className:"w-5",onChange:p,checked:r.type==="sale"}),e.jsx("span",{children:"Sale"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"offer",className:"w-5",onChange:p,checked:r.offer}),e.jsx("span",{children:"Offer"})]})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap items-center",children:[e.jsx("label",{className:"font-semibold",children:"Amenities:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"parking",className:"w-5",onChange:p,checked:r.parking}),e.jsx("span",{children:"Parking"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"checkbox",id:"furnished",className:"w-5",onChange:p,checked:r.furnished}),e.jsx("span",{children:"Furnished"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"font-semibold",children:"Sort:"}),e.jsxs("select",{onChange:p,defaultValue:"created_at_desc",id:"sort_order",className:"border rounded-lg p-3",children:[e.jsx("option",{value:"regularPrice_desc",children:"Price high to low"}),e.jsx("option",{value:"regularPrice_asc",children:"Price low to hight"}),e.jsx("option",{value:"createdAt_desc",children:"Latest"}),e.jsx("option",{value:"createdAt_asc",children:"Oldest"})]})]}),e.jsx("button",{className:"bg-slate-700 text-white p-3 rounded-lg uppercase hover:opacity-95",children:"Search"})]})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h1",{className:"text-3xl font-semibold border-b p-3 text-slate-700 mt-5",children:"Listing results:"}),e.jsxs("div",{className:"p-7 flex flex-wrap gap-4",children:[!o&&t.length===0&&e.jsx("p",{className:"text-xl text-slate-700",children:"No listing found!"}),o&&e.jsx("p",{className:"text-xl text-slate-700 text-center w-full",children:"Loading..."}),!o&&t&&t.map(l=>e.jsx(E,{listing:l},l._id)),j&&e.jsx("button",{onClick:w,className:"text-green-700 hover:underline p-7 text-center w-full",children:"Show more"})]})]})]})}function Ke(){return e.jsxs(le,{children:[e.jsx(Je,{}),e.jsxs(Se,{children:[e.jsx(F,{path:"/",element:e.jsx(Re,{})}),e.jsx(F,{path:"/sign-in",element:e.jsx(Be,{})}),e.jsx(F,{path:"/sign-up",element:e.jsx(Me,{})}),e.jsx(F,{path:"/about",element:e.jsx(qe,{})}),e.jsx(F,{path:"/search",element:e.jsx(Ve,{})}),e.jsx(F,{path:"/listing/:listingId",element:e.jsx(We,{})}),e.jsxs(F,{element:e.jsx(Ge,{}),children:[e.jsx(F,{path:"/profile",element:e.jsx(ze,{})}),e.jsx(F,{path:"/create-listing",element:e.jsx(Ye,{})}),e.jsx(F,{path:"/update-listing/:listingId",element:e.jsx(He,{})})]})]})]})}const Xe=Fe({user:Ee}),Ze={key:"root",storage:Le,version:1},es=ke(Ze,Xe),ae=fe({reducer:es,middleware:s=>s({serializableCheck:!1})}),ss=Ce(ae);ne.createRoot(document.getElementById("root")).render(e.jsx(xe,{store:ae,children:e.jsx(Pe,{loading:null,persistor:ss,children:e.jsx(Ke,{})})}));
